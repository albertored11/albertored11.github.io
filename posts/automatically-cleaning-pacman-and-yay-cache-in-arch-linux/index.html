<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Automatically cleaning pacman and yay cache in Arch Linux" /><meta property="og:locale" content="en" /><meta name="description" content="Let’s talk about something interesting for Arch Linux(-based) distros: automating package cache cleaning." /><meta property="og:description" content="Let’s talk about something interesting for Arch Linux(-based) distros: automating package cache cleaning." /><link rel="canonical" href="https://herbort.me/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/" /><meta property="og:url" content="https://herbort.me/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/" /><meta property="og:site_name" content="Herbort" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-29T19:16:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Automatically cleaning pacman and yay cache in Arch Linux" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-01-04T22:35:16+01:00","datePublished":"2021-03-29T19:16:00+02:00","description":"Let’s talk about something interesting for Arch Linux(-based) distros: automating package cache cleaning.","headline":"Automatically cleaning pacman and yay cache in Arch Linux","mainEntityOfPage":{"@type":"WebPage","@id":"https://herbort.me/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/"},"url":"https://herbort.me/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/"}</script><title>Automatically cleaning pacman and yay cache in Arch Linux | Herbort</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Herbort"><meta name="application-name" content="Herbort"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://cv.herbort.me/assets/images/profile.jpg " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Herbort</a></div><div class="site-subtitle font-italic">Yet another computer enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/albertored11" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/albertoredg/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['albertomost','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Automatically cleaning pacman and yay cache in Arch Linux</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Automatically cleaning pacman and yay cache in Arch Linux</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/albertored11">Alberto Redondo</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1617038160" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2021-03-29 </em> </span> <span> Updated <em class="timeago" data-ts="1641332116" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-01-04 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1132 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p>Let’s talk about something interesting for Arch Linux(-based) distros: automating package cache cleaning.</p><h2 id="cleaning-pacman-cache"><span class="mr-2">Cleaning pacman cache</span><a href="#cleaning-pacman-cache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>pacman is the official package manager for Arch. When using it to install a package from official repositories, it gets donwloaded, stored in our system (specifically, in <code class="language-plaintext highlighter-rouge">/var/cache/pacman/pkg</code>), and finally it is installed and the package file stays there, in case we need to reinstall it in the future (for example, if we have uninstalled it and then we want to install it again), or in case we install a newer version, it doesn’t work as expected and we want to downgrade.</p><p>However, the package cache is never cleaned automatically and, as we install and upgrade packages, it grows up in size. We could wait until our <code class="language-plaintext highlighter-rouge">/</code> is full and then cleaning it… or cleaning it automatically, keeping the files that can be useful.</p><p>pacman features an operation for cleaning cache of uninstalled packages, <code class="language-plaintext highlighter-rouge">pacman -Sc</code>, and for cleaning cache for every package, <code class="language-plaintext highlighter-rouge">pacman -Scc</code>. However, it could be interesting to clean it keeping the two latest versions of each package (the installed one and the previous one), so we always have a previous version for every package, but not every of them, in case we have to downgrade. We can achieve this using <code class="language-plaintext highlighter-rouge">paccache</code>, a script from <code class="language-plaintext highlighter-rouge">pacman-contrib</code> package.</p><p>Running <code class="language-plaintext highlighter-rouge">paccache -rk2</code>, we clean the package cache keeping just the two latest versions of each package. Furthermore, we can use <code class="language-plaintext highlighter-rouge">-u</code> option for cleaning just the cache of uninstalled packages so if, for example, we want to keep the two latest versions for installed packages and just the latest for uninstalled packages (in case we want to reinstall them in the future, for example for make dependencies of AUR packages), we could run:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>paccache <span class="nt">-rk2</span> <span class="o">&amp;&amp;</span> paccache <span class="nt">-ruk1</span>
</pre></table></code></div></div><h2 id="cleaning-yay-cache"><span class="mr-2">Cleaning yay cache</span><a href="#cleaning-yay-cache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>yay is an AUR helper and a pacman wrapper, a program that uses its features and some additional ones; in this case, installing packages from AUR, the community-driven repository for Arch users.</p><p>AUR does not store binary packages, but scripts called <code class="language-plaintext highlighter-rouge">PKGBUILD</code>s that download source or binary files from an external source and make the pacman package, and some extra files. yay does this automatically, but in the cache (located in <code class="language-plaintext highlighter-rouge">~/.cache/yay</code>) it stores not just the created package, but also original source or binary files and files generated in the process. We have to keep in mind that each package has its own cache directory.</p><p>yay has an operation <code class="language-plaintext highlighter-rouge">-Sc</code> similar to pacman’s but, again, <code class="language-plaintext highlighter-rouge">paccache</code> seems more interesting. This script has an option, <code class="language-plaintext highlighter-rouge">-c</code> for specifying cache location, so we can write the cache directory for every package installed with yay. For example, if we want to clean yay cache keeping the two latest versions for installed packages and nothing for uninstalled packages, we could run:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span>paccache <span class="nt">-rk2</span> <span class="nt">-c</span> ~/.cache/yay/<span class="k">*</span>/ <span class="o">&amp;&amp;</span> paccache <span class="nt">-ruk0</span> ~/.cache/yay/<span class="k">*</span>/
</pre></table></code></div></div><p>However, this command only removes pacman packages, but not other files. It could be interesting to keep source or binary files from installed version (in case we upgrade the package and it uses the same ones as the previous version) and the files from the git repository of the AUR package (otherwise, yay will throw an error when we try to upgrade the package), but not the rest of the source or binary files nor the ones generated during the creation of the package.</p><h2 id="bash-script-for-cleaning-both-caches"><span class="mr-2">Bash script for cleaning both caches</span><a href="#bash-script-for-cleaning-both-caches" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Tip:</strong> enable <code class="language-plaintext highlighter-rouge">batchinstall</code> option for yay to avoid extra downloads when upgrading AUR packages.</p><p>First of all, install <code class="language-plaintext highlighter-rouge">pacman-contrib</code> package if you haven’t done it yet:</p><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="gp">$</span><span class="w"> </span><span class="nb">sudo </span>pacman <span class="nt">-S</span> pacman-contrib
</pre></table></code></div></div><p>I’ve written a bash script for easily cleaning both pacman and yay caches, based on <a href="https://gist.github.com/luukvbaal/2c697b5e068471ee989bff8a56507142">these ones</a> I found on GitHub Gist, created by <a href="https://gist.github.com/luukvbaal">luukvbaal</a>.</p><div file="yaycache" class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="yaycache"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="c">##!/usr/bin/env bash</span>

<span class="c">## Assuming yay is run by user with UID 1000</span>
<span class="nv">admin</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nb">id</span> <span class="nt">-nu</span> 1000<span class="si">)</span><span class="s2">"</span>
<span class="nv">cachedir</span><span class="o">=</span><span class="s2">"/home/</span><span class="nv">$admin</span><span class="s2">/.cache/yay"</span>
<span class="nv">removed</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span><span class="nb">comm</span> <span class="nt">-23</span> &lt;<span class="o">(</span><span class="nb">basename</span> <span class="nt">-a</span> <span class="si">$(</span>find <span class="nv">$cachedir</span> <span class="nt">-mindepth</span> 1 <span class="nt">-maxdepth</span> 1 <span class="nt">-type</span> d<span class="si">)</span> | <span class="nb">sort</span><span class="o">)</span> &lt;<span class="o">(</span>pacman <span class="nt">-Qqm</span><span class="o">)</span> | xargs <span class="nt">-r</span> <span class="nb">printf</span> <span class="s2">"</span><span class="nv">$cachedir</span><span class="s2">/%s</span><span class="se">\n</span><span class="s2">"</span><span class="si">)</span><span class="s2">"</span>

<span class="c">## Remove yay cache for foreign packages that are not installed anymore</span>
<span class="nb">rm</span> <span class="nt">-rf</span> <span class="nv">$removed</span>

<span class="nv">pkgcache</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>find <span class="nv">$cachedir</span> <span class="nt">-mindepth</span> 1 <span class="nt">-maxdepth</span> 1 <span class="nt">-type</span> d | xargs <span class="nt">-r</span> <span class="nb">printf</span> <span class="s2">"-c %s</span><span class="se">\n</span><span class="s2">"</span><span class="si">)</span><span class="s2">"</span>

<span class="k">for </span>pkgdir <span class="k">in</span> <span class="s2">"</span><span class="nv">$cachedir</span><span class="s2">"</span>/<span class="k">*</span>/<span class="p">;</span> <span class="k">do

    </span><span class="nv">pkgname</span><span class="o">=</span><span class="si">$(</span><span class="nb">basename</span> <span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">"</span><span class="si">)</span>

    <span class="c">## Remove untracked files (e. g. source/build files) excepting package files and main source files for installed version if non-git package</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="o">!</span> <span class="s2">"</span><span class="nv">$pkgname</span><span class="s2">"</span> <span class="o">=</span>~ ^.<span class="k">*</span><span class="nt">-git</span><span class="nv">$ </span><span class="o">]]</span><span class="p">;</span> <span class="k">then

        </span><span class="nv">pkgver</span><span class="o">=</span><span class="s2">"</span><span class="si">$(</span>pacman <span class="nt">-Q</span> <span class="nv">$pkgname</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f2</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">'-'</span> <span class="nt">-f1</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">':'</span> <span class="nt">-f2</span><span class="si">)</span><span class="s2">"</span>

        <span class="nb">cd</span> <span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">"</span>
        <span class="nb">rm</span> <span class="nt">-f</span> <span class="si">$(</span>git ls-files <span class="nt">--others</span> | <span class="nb">grep</span> <span class="nt">-v</span> <span class="nt">-e</span> <span class="s1">'^.*\.pkg\.tar.*$'</span> <span class="nt">-e</span> <span class="s1">'^.*/$'</span> <span class="nt">-e</span> <span class="s2">"^.*</span><span class="nv">$pkgver</span><span class="s2">.*$"</span> | xargs <span class="nt">-r</span> <span class="nb">printf</span> <span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">/%s</span><span class="se">\n</span><span class="s2">"</span><span class="si">)</span>

    <span class="k">fi

    </span><span class="nb">rm</span> <span class="nt">-rf</span> <span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">"</span>/src/

<span class="k">done</span>

<span class="c">## Remove everything for uninstalled foreign packages, keep latest version for uninstalled native packages, keep two latest versions for installed packages</span>
/usr/bin/paccache <span class="nt">-qruk0</span> <span class="nv">$pkgcache</span>
/usr/bin/paccache <span class="nt">-qruk1</span>
/usr/bin/paccache <span class="nt">-qrk2</span> <span class="nt">-c</span> /var/cache/pacman/pkg <span class="nv">$pkgcache</span>
</pre></table></code></div></div><p>It cleans both caches using <code class="language-plaintext highlighter-rouge">paccache</code>, keeping the two latest versions for installed packages, the latest version for uninstalled packages from official repositories and nothing for uninstalled packages from AUR, it removes the directories of uninstalled packages from AUR located in yay cache and extra files from the directories of insatlled packages, excepting the files tracked by git, the pacman packages and the source or binary files of the installed version.</p><p>We can save the script, for example, in <code class="language-plaintext highlighter-rouge">~/.local/bin</code>, or whichever directory you prefer from your <code class="language-plaintext highlighter-rouge">$PATH</code>, so we can run it just typing <code class="language-plaintext highlighter-rouge">yaycache</code>.</p><h2 id="pacman-hook-for-automating-cache-cleaning"><span class="mr-2">Pacman hook for automating cache cleaning</span><a href="#pacman-hook-for-automating-cache-cleaning" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This script can be useful for cleaning pacman and yay caches, but we haven’t reached the automation part yet.</p><p>In order to implement automation, I’ve written a pacman hook, a file that runs a command after installing, removing or upgrading certain packages.</p><p>In this case, the script is run after removing or upgrading any package. It does not run after installing a package, because yay installs make dependencies when needed and running the script would remove necessary files and therefore installation would fail.</p><div file="yaycache.hook" class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="yaycache.hook"><i class="far fa-file-code"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>[Trigger]
Operation = Upgrade
Operation = Remove
Type = Package
Target = *

[Action]
Description = Cleaning pacman and yay cache...
When = PostTransaction
Exec = /home/herbort/.local/bin/yaycache
Depends = pacman-contrib
</pre></table></code></div></div><p>Don’t forget to change <code class="language-plaintext highlighter-rouge">Exec</code> path so it points to the right path where you saved the script.</p><p>We have to save the hook file in <code class="language-plaintext highlighter-rouge">/usr/share/libalpm/hooks</code>, so it gets triggered when using pacman.</p><h2 id="and-thats-all"><span class="mr-2">And that’s all…</span><a href="#and-thats-all" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I hope this way of cleaning pacman and yay caches is useful for you and, of course, I appreciate any suggestions and comments.</p><p>You can find both files in this <a href="https://gist.github.com/albertored11/bfc0068f4e43ca0d7ce0af968f7314db">gist</a>!</p><script src="https://giscus.app/client.js" data-repo="albertored11/albertored11.github.io" data-repo-id="R_kgDOGKssHw" data-category="Comments" data-category-id="DIC_kwDOGKssH84CAOH7" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-theme="transparent_dark" data-lang="en" crossorigin="anonymous" async=""> </script></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/linux/'>Linux</a>, <a href='/categories/system-administration/'>System administration</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/arch-linux/" class="post-tag no-text-decoration" >arch linux</a> <a href="/tags/pacman/" class="post-tag no-text-decoration" >pacman</a> <a href="/tags/yay/" class="post-tag no-text-decoration" >yay</a> <a href="/tags/bash/" class="post-tag no-text-decoration" >bash</a> <a href="/tags/cache/" class="post-tag no-text-decoration" >cache</a> <a href="/tags/script/" class="post-tag no-text-decoration" >script</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Automatically cleaning pacman and yay cache in Arch Linux - Herbort&amp;url=https://herbort.me/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://t.me/share/url?url=https://herbort.me/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/&amp;text=Automatically cleaning pacman and yay cache in Arch Linux - Herbort" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://herbort.me/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/automatically-cleaning-pacman-and-yay-cache-in-arch-linux/">Automatically cleaning pacman and yay cache in Arch Linux</a><li><a href="/posts/ssd-hdd-storage-setup-in-a-linux-desktop-with-bind-mount/">SSD + HDD storage setup in a Linux desktop with bind mount</a><li><a href="/posts/bsptab-tabs-in-bspwm-with-tabbed/">bsptab — tabs in bspwm with tabbed!</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/script/">script</a> <a class="post-tag" href="/tags/arch-linux/">arch linux</a> <a class="post-tag" href="/tags/bind/">bind</a> <a class="post-tag" href="/tags/bspwm/">bspwm</a> <a class="post-tag" href="/tags/cache/">cache</a> <a class="post-tag" href="/tags/ddcutil/">ddcutil</a> <a class="post-tag" href="/tags/display/">display</a> <a class="post-tag" href="/tags/fstab/">fstab</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/bsptab-tabs-in-bspwm-with-tabbed/"><div class="card-body"> <em class="timeago small" data-ts="1630586340" > 2021-09-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>bsptab — tabs in bspwm with tabbed!</h3><div class="text-muted small"><p> Today, I’m going to show you a project I’ve been working on the last days. It is now more than two years that I came back to Linux. I tried Manjaro first, then moved to Arch. And at first I used...</p></div></div></a></div><div class="card"> <a href="/posts/managing-external-display-configuration-with-ddcutil/"><div class="card-body"> <em class="timeago small" data-ts="1669553220" > 2022-11-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Managing external display configuration with ddcutil</h3><div class="text-muted small"><p> Almost every laptop keyboard include two function keys: one to decrease the brightness of the screen and other to increase it. In most Linux desktop environments, those two keys work out-of-the-bo...</p></div></div></a></div><div class="card"> <a href="/posts/ssd-hdd-storage-setup-in-a-linux-desktop-with-bind-mount/"><div class="card-body"> <em class="timeago small" data-ts="1635525360" > 2021-10-29 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SSD + HDD storage setup in a Linux desktop with bind mount</h3><div class="text-muted small"><p> Hi everyone! Today I’m going to share with you how I have set up my storage in my desktop PC using a 250 GB SSD and a 2 TB HDD. Background Back in august 2020, I built my own desktop PC with the ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <a href="/posts/bsptab-tabs-in-bspwm-with-tabbed/" class="btn btn-outline-primary" prompt="Newer"><p>bsptab — tabs in bspwm with tabbed!</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/albertored11">Alberto Redondo</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bash/">bash</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/script/">script</a> <a class="post-tag" href="/tags/arch-linux/">arch linux</a> <a class="post-tag" href="/tags/bind/">bind</a> <a class="post-tag" href="/tags/bspwm/">bspwm</a> <a class="post-tag" href="/tags/cache/">cache</a> <a class="post-tag" href="/tags/ddcutil/">ddcutil</a> <a class="post-tag" href="/tags/display/">display</a> <a class="post-tag" href="/tags/fstab/">fstab</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-PLB8F1YJYS"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-PLB8F1YJYS'); }); </script>
